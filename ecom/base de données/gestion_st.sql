DROP DATABASE IF EXISTS gestion_st;
CREATE DATABASE IF NOT EXISTS gestion_st;

USE gestion_st;

CREATE TABLE UTILISATEUR (
	IDUSER int(4) AUTO_INCREMENT PRIMARY KEY,
	LOGIN VARCHAR(100),
	PWD VARCHAR(255),
	ROLE VARCHAR(50),
	EMAIL VARCHAR(255),
	ETAT INT(1)
); 

		
CREATE TABLE PRODUIT (
	IDPRODUIT int(4) AUTO_INCREMENT PRIMARY KEY,
	nameP VARCHAR(50),
	DESCRIPTION VARCHAR(50),
	PHOTO VARCHAR(50),
    QUANTITEENTREPOT VARCHAR(50),
    QUANTITELIVREUR VARCHAR(50),
    type VARCHAR(50)
);

CREATE TABLE COMMUN (
	IDUSER int(4),
    IDPRODUIT int(4)
);


	
ALTER TABLE COMMUN ADD constraint fk1 foreign key(IDUSER) references UTILISATEUR(IDUSER);
ALTER TABLE COMMUN ADD constraint fk2 foreign key(IDPRODUIT) references PRODUIT(IDPRODUIT);

INSERT INTO UTILISATEUR(IDUSER,LOGIN,PWD,ROLE,EMAIL,ETAT) VALUES
	(1,'admin',md5('123'),'ADMIN','lahcenabousalih@gmail.com',1),
	(2,'user1',md5('123'),'LIVREUR','user1@gmail.com',0),
	(3,'user2',md5('123'),'UTILISATEUR','user2@gmail.com',1),
    (4,'user3',md5('123'),'UTILISATEUR','user3@gmail.com',1);	

INSERT INTO PRODUIT(IDPRODUIT,nameP,DESCRIPTION,PHOTO,QUANTITEENTREPOT,QUANTITELIVREUR,type) VALUES
    (1,'TWS2','DES ECOUTEURS DE QUALITE','User.png','250','10','A'),
	(2,'TWS90','DES ECOUTEURS DE QUALITE','user_green.png','250','10','B'),
	(3,'TWS59','DES ECOUTEURS DE QUALITE','User.png','250','10','C'),
	(4,'TWS20','DES ECOUTEURS DE QUALITE','User.png','250','10','C'),
	(5,'TWS900','DES ECOUTEURS DE QUALITE','user_green.png','250','10','C'),
	(6,'TWS590','DES ECOUTEURS DE QUALITE','User.png','250','10','A'),
    (7,'TWS200','DES ECOUTEURS DE QUALITE','User.png','250','10','B'),
	(8,'TWS9000','DES ECOUTEURS DE QUALITE','user_green.png','250','10','A'),
	(9,'TWS5900','DES ECOUTEURS DE QUALITE','User.png','250','10','C');
    
INSERT INTO COMMUN(IDUSER,IDPRODUIT) VALUES
	(1,3),
	(2,1),
	(3,8),
    (4,6),
    (1,3),
	(4,1),
	(5,9),
    (4,6),
    (1,3),
	(2,5),
	(4,8),
    (4,4),
    (1,3),
	(2,2),
	(3,8),
    (4,6),
    (4,3),
	(2,1),
	(2,8),
    (4,6);

SELECT * FROM COMMUN;   
SELECT * FROM UTILISATEUR;
SELECT * FROM PRODUIT;
SELECT * FROM UTILISATEUR U,PRODUIT P,COMMUN C
WHERE U.IDUSER = C.IDUSER AND P.IDPRODUIT = C.IDPRODUIT;